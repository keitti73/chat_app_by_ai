# 🌟 AWS AppSync チャットアプリ

このプロジェクトは、**Amazon Web Services (AWS)** という雲サービスを使って作る、**リアルタイムチャットアプリ**です。

## 📱 何ができるアプリ？

- 🏠 **チャットルームを作る**: 好きな名前でルームを作成
- 💬 **リアルタイムでメッセージ**: LINEのように即座にメッセージが届く
- 👥 **複数人でチャット**: 同じルームにいる人全員でおしゃべり
- 📋 **ルーム一覧**: 自分が作ったルームや参加したルームを一覧表示
- ⏰ **メッセージ履歴**: 過去のメッセージもちゃんと見れる

## 🔧 使っている技術（中学生向け説明）

- 🎨 **React + Vite**: ウェブサイトの見た目と動きを作る技術
- ☁️ **AWS AppSync**: Amazon の「GraphQL API」サービス（サーバーとの通信担当）
- 🗄️ **Amazon DynamoDB**: Amazon のデータベース（メッセージやルーム情報を保存）
- ⚡ **GraphQL Subscriptions**: リアルタイム通信の仕組み（新着メッセージを瞬時に通知）
- 🏗️ **Terraform**: コードでAWSのサービスを自動で作る技術
- 🔐 **API Key認証**: 簡単な認証方式（将来はもっと高度な認証も予定）

## 🚀 アプリを動かしてみよう！

### ステップ1: 必要なものをダウンロード
```bash
# Node.js の部品をダウンロード
npm install
```

### ステップ2: AWS（雲サービス）に必要な機能を作る
```bash
# 自動で作るスクリプトを実行
npm run deploy

# または手動で作る場合
cd infra
terraform init
terraform apply
```

### ステップ3: 設定ファイルを作る
```bash
# 設定例をコピーして、自分用の設定ファイルを作る
cp .env.example .env

# .env ファイルを開いて、ステップ2で表示された値を入力する
```

### ステップ4: アプリを起動する
```bash
# ローカルサーバーを起動（ブラウザで http://localhost:3000 を開く）
npm run dev
```

## 📁 プロジェクトの構成（ファイルの説明）

このプロジェクトは、以下のような構成になっています：

```
├── src/                           # 📱 アプリの画面とロジック
│   ├── components/                # 🧩 画面の部品たち
│   │   ├── MyRooms.jsx           # 🏠 ルーム一覧画面
│   │   └── ChatRoom.jsx          # 💬 チャット画面
│   ├── graphql/                   # 📡 サーバーとの通信設定
│   │   ├── queries.js            # 📖 データを「読む」ための命令
│   │   ├── mutations.js          # ✏️ データを「変更する」ための命令
│   │   └── subscriptions.js      # 🔔 リアルタイム通知の設定
│   ├── App.jsx                    # 🏠 アプリ全体をコントロールするメインファイル
│   └── main.jsx                   # 🚀 アプリの起動ファイル
├── infra/                         # ☁️ AWS（雲サービス）の設定
│   ├── main.tf                   # ⚙️ 基本設定
│   ├── dynamodb.tf               # 🗄️ データベースの設定
│   ├── appsync.tf                # 📡 API サーバーの設定
│   ├── resolvers.tf              # 🔄 データ処理ロジックの設定
│   └── outputs.tf                # 📋 作成したサービスの情報出力
├── resolvers/                     # 🧠 サーバー側のデータ処理ロジック
├── schema.graphql                 # 📝 データの設計図
└── vite.config.js                # ⚡ 開発用ツールの設定
```

## 🛠 実装されている機能

- ✅ **チャットルームの作成**: 好きな名前でルームを作れる
- ✅ **リアルタイムメッセージング**: 送信と同時に相手の画面に表示
- ✅ **ルーム一覧表示**: 自分のルームと参加ルームを分けて表示
- ✅ **メッセージ履歴表示**: 過去のメッセージを時系列で表示
- ✅ **リアルタイム通知**: 新着メッセージやルーム作成を即座に通知

## 📚 技術の詳細説明

- 🎨 **フロントエンド**: React + Vite（画面作成 + 高速開発環境）
- 🌐 **バックエンド**: AWS AppSync（GraphQL API サーバー）
- 🗄️ **データベース**: Amazon DynamoDB（NoSQL データベース）
- ⚡ **リアルタイム**: GraphQL Subscriptions（WebSocket ベースの通信）
- 🏗️ **インフラ**: Terraform（Infrastructure as Code）
- 🔐 **認証**: Amazon API Key（シンプル認証、将来は Cognito 予定）

## 🔧 開発時の注意点（重要！）

1. 🔑 **AWS認証情報**: AWS CLIで自分のAWSアカウント情報を設定してください
2. 📝 **環境変数**: `.env.example`をコピーして`.env`ファイルを作成し、Terraform outputの値を設定してください
3. 🔐 **API認証**: 現在はAPI Keyを使用しています（本番環境ではCognitoを推奨）
4. 🔒 **機密情報**: `.env`ファイルや`terraform.tfvars`などの機密情報は`.gitignore`で除外されています

## 🚀 詳細なデプロイ手順

### ステップ1: AWS認証情報の設定
```bash
# AWS CLIで自分のアカウント情報を設定
aws configure
# ↑ ここでアクセスキーとシークレットキーを入力
```

### ステップ2: AWSリソースのデプロイ
```bash
# 全自動でAWSにサービスを作成
npm run deploy
```

### ステップ3: 環境変数の設定
Terraform outputから出力される値を`.env`ファイルに設定:
```bash
# 設定ファイルのテンプレートをコピー
cp .env.example .env

# .envファイルを開いて、ステップ2で表示された値を入力
# 例: VITE_APPSYNC_GRAPHQL_ENDPOINT=https://xxxxxxxxx.appsync-api.us-east-1.amazonaws.com/graphql
```

### ステップ4: アプリケーションの起動
```bash
# 開発サーバーを起動
npm run dev
# ↑ ブラウザで http://localhost:3000 を開く
```

## 🎓 学習ポイント（何を学べるか）

このプロジェクトを通して、以下の技術を学ぶことができます：

- 📱 **React開発**: モダンなWebアプリの作り方
- ☁️ **クラウド開発**: AWSを使ったサーバーレス開発
- 📡 **API設計**: GraphQLを使った効率的なデータ通信
- 🗄️ **データベース設計**: NoSQLデータベースの設計方法
- ⚡ **リアルタイム通信**: WebSocketを使った即座のデータ同期
- 🏗️ **Infrastructure as Code**: コードでインフラを管理する方法

## 📝 今後の改善予定（TODO）

- [ ] 🔐 **Cognito認証の実装**: より安全なユーザー認証システム
- [ ] 🛡️ **エラーハンドリングの改善**: エラーが起きた時の対応を充実
- [ ] 🎨 **UI/UXの向上**: より使いやすく美しいデザイン
- [ ] 🧪 **テストの追加**: アプリが正しく動くかを自動でチェック
- [ ] 🚀 **デプロイメント自動化**: GitHub に push したら自動でデプロイ
- [ ] 📎 **ファイル添付機能**: 画像や動画を送れるように
- [ ] 😊 **絵文字・スタンプ**: チャットをもっと楽しく
- [ ] 🔒 **プライベートルーム**: パスワード付きのルーム機能

## 🆘 困った時は

### よくある問題と解決方法

1. **「npm install でエラーが出る」**
   - Node.js がインストールされているか確認
   - `npm cache clean --force` を試してみる

2. **「terraform apply でエラーが出る」**
   - AWS CLI の認証情報が正しく設定されているか確認
   - AWS の利用権限があるか確認

3. **「アプリが真っ白で何も表示されない」**
   - ブラウザの開発者ツール（F12）でエラーメッセージを確認
   - `.env` ファイルの設定値が正しいか確認

### 追加学習リソース

- 📖 **React公式チュートリアル**: https://ja.react.dev/learn
- ☁️ **AWS AppSync入門**: https://docs.aws.amazon.com/appsync/
- 📡 **GraphQL学習**: https://graphql.org/learn/
- 🏗️ **Terraform入門**: https://developer.hashicorp.com/terraform/tutorials

## 📄 ライセンス・お問い合わせ

- 🆓 **ライセンス**: このプロジェクトは学習・個人利用自由です
- 💬 **質問・相談**: GitHub の Issues でお気軽にどうぞ
- 🤝 **貢献**: プルリクエストやフィードバック大歓迎！

---

**🌟 Happy Coding! 楽しくプログラミングを学びましょう！ 🌟**
